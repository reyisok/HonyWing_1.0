<UserControl x:Class="HonyWing.UI.Controls.ImageUploadControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:ui="http://schemas.modernwpf.com/2019"
             mc:Ignorable="d"
             d:DesignHeight="400" d:DesignWidth="600"
             AllowDrop="True"
             Drop="OnDrop"
             DragEnter="OnDragEnter"
             DragLeave="OnDragLeave"
             DragOver="OnDragOver"
             Background="{StaticResource DarkBlueBackgroundBrush}">

    <UserControl.Resources>
        <Style x:Key="UploadAreaStyle" TargetType="Border">
            <Setter Property="BorderBrush" Value="{StaticResource DarkBlueBorderBrush}"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Background" Value="{StaticResource DarkBlueBackgroundBrush}"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="20"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="BorderBrush" Value="{StaticResource DarkBlueAccentBrush}"/>
                    <Setter Property="Background" Value="{StaticResource DarkBlueHoverBrush}"/>
                    <Setter Property="Opacity" Value="0.8"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="DragOverStyle" TargetType="Border" BasedOn="{StaticResource UploadAreaStyle}">
            <Setter Property="BorderBrush" Value="{StaticResource DarkBlueAccentBrush}"/>
            <Setter Property="Background" Value="{StaticResource DarkBlueHoverBrush}"/>
            <Setter Property="Opacity" Value="0.6"/>
        </Style>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 标题栏 -->
        <Grid Grid.Row="0" Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Column="0"
                       Text="图像上传与预览"
                       FontSize="13"
                       FontWeight="SemiBold"
                       Foreground="{StaticResource WhiteForegroundBrush}"/>

            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <Button Name="BrowseButton"
                        Content="浏览文件"
                        Style="{StaticResource DarkBlueButtonStyle}"
                        Margin="0,0,10,0"
                        Click="OnBrowseClick"/>
                <Button Name="PasteButton"
                        Content="从剪贴板粘贴"
                        Style="{StaticResource DarkBlueButtonStyle}"
                        Margin="0,0,10,0"
                        Click="OnPasteClick"/>
                <Button Name="ClearButton"
                        Content="清空"
                        Style="{StaticResource DarkBlueButtonStyle}"
                        Click="OnClearClick"
                        IsEnabled="False"/>
            </StackPanel>
        </Grid>

        <!-- 主内容区域 -->
        <Grid Grid.Row="1">
            <!-- 上传区域 -->
            <Border Name="UploadArea"
                    Style="{StaticResource UploadAreaStyle}"
                    Visibility="Visible">
                <StackPanel HorizontalAlignment="Center"
                            VerticalAlignment="Center">
                    <!-- <ui:FontIcon Glyph="&#xE8B5;"
                                 FontSize="48"
                                 Margin="0,0,0,15"
                                 Foreground="{StaticResource WhiteForegroundBrush}"/> -->
                    <TextBlock Text="📁"
                               FontSize="48"
                               Margin="0,0,0,15"
                               HorizontalAlignment="Center"
                               Foreground="{StaticResource WhiteForegroundBrush}"/>
                    <TextBlock Text="拖拽图像文件到此处"
                               FontSize="13"
                               Margin="0,0,0,15"
                               HorizontalAlignment="Center"
                               Foreground="{StaticResource WhiteForegroundBrush}"/>
                    <TextBlock Text="或点击'浏览文件'按钮选择图像"
                               FontSize="13"
                               HorizontalAlignment="Center"
                               Foreground="{StaticResource WhiteForegroundBrush}"/>
                    <TextBlock Name="SupportedFormatsText"
                               Text="支持格式：PNG, JPG, JPEG, BMP"
                               FontSize="12"
                               HorizontalAlignment="Center"
                               Foreground="{StaticResource WhiteForegroundBrush}"/>
                </StackPanel>
            </Border>

            <!-- 预览区域 -->
            <Grid Name="PreviewArea" Visibility="Collapsed">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- 图像预览 -->
                <Border Grid.Row="0"
                        Background="{StaticResource DarkBlueBackgroundBrush}"
                        BorderBrush="{StaticResource DarkBlueBorderBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Margin="0,0,0,10">
                    <Grid>
                        <ScrollViewer Name="ImageScrollViewer"
                                      HorizontalScrollBarVisibility="Auto"
                                      VerticalScrollBarVisibility="Auto">
                            <Image Name="PreviewImage"
                                   Stretch="None"
                                   RenderTransformOrigin="0.5,0.5">
                                <Image.RenderTransform>
                                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                                </Image.RenderTransform>
                            </Image>
                        </ScrollViewer>

                        <!-- 缩放控制按钮 -->
                        <StackPanel Orientation="Horizontal"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Top"
                                    Margin="10"
                                    Background="{StaticResource DarkBlueBackgroundBrush}"
                                    Opacity="0.9">
                            <Button Name="ZoomOutButton"
                                    Content="0.5:1"
                                    ToolTip="缩小到50%"
                                    Style="{StaticResource DarkBlueButtonStyle}"
                                    Width="50" Height="30"
                                    Margin="2"
                                    Click="OnZoomOutClick"/>
                            <Button Name="ZoomOriginalButton"
                                    Content="1:1"
                                    ToolTip="原始尺寸"
                                    Style="{StaticResource DarkBlueButtonStyle}"
                                    Width="50" Height="30"
                                    Margin="2"
                                    Click="OnZoomOriginalClick"/>
                            <Button Name="ZoomInButton"
                                    Content="2:1"
                                    ToolTip="放大到200%"
                                    Style="{StaticResource DarkBlueButtonStyle}"
                                    Width="50" Height="30"
                                    Margin="2"
                                    Click="OnZoomInClick"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- 图像信息 -->
                <Expander Grid.Row="1"
                          Header="图像信息"
                          IsExpanded="True"
                          Background="{StaticResource DarkBlueBackgroundBrush}"
                          Foreground="{StaticResource WhiteForegroundBrush}">
                    <Grid Margin="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0"
                                   Text="文件名："
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource WhiteForegroundBrush}"
                                   Margin="0,0,10,5"/>
                        <StackPanel Grid.Row="0" Grid.Column="1"
                                    Orientation="Horizontal"
                                    Margin="0,0,20,5">
                            <TextBox Name="FileNameEditBox"
                                     Style="{StaticResource DarkBlueTextBoxStyle}"
                                     Width="200"
                                     Margin="0,0,5,0"
                                     LostFocus="OnFileNameLostFocus"/>
                            <Button Name="RenameButton"
                                    Content="重命名"
                                    Style="{StaticResource DarkBlueButtonStyle}"
                                    Width="60" Height="25"
                                    Click="OnRenameClick"/>
                        </StackPanel>

                        <TextBlock Grid.Row="0" Grid.Column="2"
                                   Text="文件大小："
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource WhiteForegroundBrush}"
                                   Margin="0,0,10,5"/>
                        <TextBlock Grid.Row="0" Grid.Column="3"
                                   Name="FileSizeText"
                                   FontSize="12"
                                   Foreground="{StaticResource WhiteForegroundBrush}"
                                   Margin="0,0,0,5"/>

                        <TextBlock Grid.Row="1" Grid.Column="0"
                                   Text="图像尺寸："
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource WhiteForegroundBrush}"
                                   Margin="0,0,10,5"/>
                        <TextBlock Grid.Row="1" Grid.Column="1"
                                   Name="ImageSizeText"
                                   FontSize="12"
                                   Foreground="{StaticResource WhiteForegroundBrush}"
                                   Margin="0,0,20,5"/>

                        <TextBlock Grid.Row="1" Grid.Column="2"
                                   Text="图像格式："
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource WhiteForegroundBrush}"
                                   Margin="0,0,10,5"/>
                        <TextBlock Grid.Row="1" Grid.Column="3"
                                   Name="ImageFormatText"
                                   FontSize="12"
                                   Foreground="{StaticResource WhiteForegroundBrush}"
                                   Margin="0,0,0,5"/>

                        <TextBlock Grid.Row="2" Grid.Column="0"
                                   Text="分辨率："
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource WhiteForegroundBrush}"
                                   Margin="0,0,10,5"/>
                        <TextBlock Grid.Row="2" Grid.Column="1"
                                   Name="ResolutionText"
                                   FontSize="12"
                                   Foreground="{StaticResource WhiteForegroundBrush}"
                                   Margin="0,0,20,5"/>

                        <TextBlock Grid.Row="2" Grid.Column="2"
                                   Text="色彩深度："
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource WhiteForegroundBrush}"
                                   Margin="0,0,10,5"/>
                        <TextBlock Grid.Row="2" Grid.Column="3"
                                   Name="ColorDepthText"
                                   FontSize="12"
                                   Foreground="{StaticResource WhiteForegroundBrush}"
                                   Margin="0,0,0,5"/>

                        <TextBlock Grid.Row="3" Grid.Column="0"
                                   Text="创建时间："
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource WhiteForegroundBrush}"
                                   Margin="0,0,10,5"/>
                        <TextBlock Grid.Row="3" Grid.Column="1"
                                   Name="CreationTimeText"
                                   FontSize="12"
                                   Foreground="{StaticResource WhiteForegroundBrush}"
                                   Margin="0,0,20,5"/>

                        <TextBlock Grid.Row="4" Grid.Column="0"
                                   Text="备注："
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource WhiteForegroundBrush}"
                                   Margin="0,0,10,5"/>
                        <TextBox Grid.Row="4" Grid.Column="1"
                                 Grid.ColumnSpan="3"
                                 Name="CommentTextBox"
                                 Style="{StaticResource DarkBlueTextBoxStyle}"
                                 Height="28"
                                 TextWrapping="Wrap"
                                 AcceptsReturn="True"
                                 VerticalScrollBarVisibility="Auto"
                                 Margin="0,0,0,5"
                                 LostFocus="OnCommentLostFocus"/>

                        <TextBlock Grid.Row="5" Grid.Column="0"
                                   Text="文件路径："
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource WhiteForegroundBrush}"
                                   Margin="0,0,10,0"/>
                        <TextBlock Grid.Row="5" Grid.Column="1"
                                   Grid.ColumnSpan="3"
                                   Name="FilePathText"
                                   FontSize="13"
                                   TextWrapping="Wrap"
                                   Foreground="{StaticResource WhiteForegroundBrush}"/>
                    </Grid>
                </Expander>
            </Grid>
        </Grid>

        <!-- 操作按钮栏 -->
        <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,10,0,0"
                    Name="ActionButtons"
                    Visibility="Collapsed">

            <Button Name="CopyToClipboardButton"
                    Content="复制到剪贴板"
                    Style="{StaticResource DarkBlueButtonStyle}"
                    Click="OnCopyToClipboardClick"/>
            <Button Name="SaveAsButton"
                    Content="另存为"
                    Style="{StaticResource DarkBlueButtonStyle}"
                    Click="OnSaveAsClick"/>
        </StackPanel>
    </Grid>
</UserControl>
